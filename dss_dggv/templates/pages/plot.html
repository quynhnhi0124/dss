{% extends "pages/base.html" %}
{% load static %}
{% block title %}Thống kê{% endblock  %}
{% block content %}
<link rel="stylesheet" href="{% static 'css/plot.css' %}"/>

<div class="content col-md-10">
  <div class="container">
    <div class="head-thumbnail">
        <h1 class = "display-4"  style ="margin: 45px 0;">Thống kê</h1>
    </div>
    <div class="row col-md-8 justify-content-center">
      <canvas id="plot" data-url="{% url 'plot' %}"></canvas>
    </div>
    <div class="col-md-4 detail">
      <h3>Kết quả thống kê của bảng học vị</h3>
    </div>
  </div> 
</div>




<script type="text/javascript" src="{% static 'js/Chart.min.js' %}"></script>
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>
  <script>

    var config = {
      type: 'bar',
      data: {
        datasets: [{
          label: 'Hoc vi',
          backgroundColor: '#449c87',
          data: {{ data|safe }},
        }],
        labels: {{ labels|safe }}
      },
      options: {
        responsive: true,
        legend: {
          position: 'top',
        },
      }
    };

    window.onload = function() {
      var ctx = document.getElementById('plot').getContext('2d');
      window.myPie = new Chart(ctx, config);
    };


    {% comment %} $(function () {

      var $hocviChart = $("#plot");
      $.ajax({
        url: $hocviChart.data("url"),
        success: function (data) {

          var ctx = $hocviChart[0].getContext("2d");

          new Chart(ctx, {
            type: 'bar',
            data: {
              labels: data.labels,
              datasets: [{
                label: 'học vị',
                backgroundColor: 'blue',
                data: data.data
              }]          
            },
            options: {
              responsive: true,
              legend: {
                position: 'bottom',
              },
              title: {
                display: true,
                text: 'Thống kê học vị'
              }
            }
          });

        }
      });

    }); {% endcomment %}

  </script>
{% endblock %}